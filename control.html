<!DOCTYPE html>
<html lang="en">

<head>

  <title>RSC Stream</title>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lodash@4.17.15/lodash.min.js"></script>
  <script type="text/javascript" src="http://mbostock.github.com/d3/d3.js?2.4.6"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-transform/1.0.4/d3-transform.min.js" integrity="sha512-mxtQ5axoakkabgk9lnYJsaCL+BryRmZ4py80vqOf8UIbZhwc+m1bqmnge6Khd7sOLh2gPFCaKiynJEnqR79CaA==" crossorigin="anonymous"></script>
  

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css'>
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css'>

  
</head>

<body>

    <select id="tier-dropdown" name="tier" onchange="teams(); tier()">
    </select>
<select id="blue-team" name="BlueTeam" onchange="bluNam()"></select>
<select id="orange-team" name="OrangeTeam" onchange="oranNam()"></select>

<script>
    var teamsList = [];
    let dropdownBlue = document.getElementById('blue-team');
    let dropdownOrange = document.getElementById('orange-team');
    let dropdown = document.getElementById('tier-dropdown');
dropdown.length = 0;
dropdownBlue.length = 0;
dropdownOrange.length = 0;

let defaultOption = document.createElement('option');
defaultOption.text = 'Choose Tier';

let defaultOptionBlue = document.createElement('option');
defaultOptionBlue.text = 'Choose Blue Team';

let defaultOptionOrange = document.createElement('option');
defaultOptionOrange.text = 'Choose Orange Team';

dropdown.add(defaultOption);
dropdown.selectedIndex = 0;

dropdownBlue.add(defaultOptionBlue);
dropdownBlue.selectedIndex = 0;

dropdownOrange.add(defaultOptionOrange);
dropdownOrange.selectedIndex = 0;

const url = 'https://cors-anywhere.herokuapp.com/https://rsc.webfillet.com/RSCdotNet/api/stats';

const request = new XMLHttpRequest();
request.open('GET', url, true);

request.onload = function() {
  if (request.status === 200) {
    const data = JSON.parse(request.responseText);
    console.log(data)
    teamsList.push(data)
    console.log(teamsList)
    let option;
    for (let i = 0; i < data.length; i++) {
      option = document.createElement('option');
      option.text = data[i].TierName;
      //option.value = data[i].abbreviation;
      dropdown.add(option);
      

      
    }
   } else {
    // Reached the server, but it returned an error
  }   
}

request.onerror = function() {
  console.error('An error occurred fetching the JSON from ' + url);
};

request.send();

function teams() {
    var teams = [];
    var id = [];
    var tier = document.getElementById("tier-dropdown").value;
    console.log(tier)
    id.length = 0;
    if(tier === "Premier"){
        id.push(0)
    }else if(tier === "Master"){
        id.push(1)
    }else if(tier === "Elite"){
        id.push(2)
    }else if(tier === "Major"){
        id.push(3)
    }else if(tier === "Minor"){
        id.push(4)
    }else if(tier === "Challenger"){
        id.push(5)
    }else if(tier === "Prospect"){
        id.push(6)
    }else if(tier === "Contender"){
        id.push(7)
    }else if(tier === "Amateur"){
        id.push(8)
    }

console.log(teamsList[0][0])
    teams.length = 0;
			teamsList[0][id].Teams.forEach(f => {
    teams.push({team: f.TeamName, franchise: f.Franchise});
    })
    console.log(teams)
    let teamArray = [];
    teamArray = []
    console.log(teamArray)
    for (let i = 0; i < teams.length; i++) {
        teamArray.push(
        {"label": teams[i].team, "value": teams[i].franchise}
        );if (i ===teams.length -1)

teamArray.sort(function(a, b){
    if(a.label < b.label) { return -1; }
    if(a.label > b.label) { return 1; }
    return 0;
})


 }
 let option1 = []
 option1 = []
 let option = [];
 option = [];
 
 //document.getElementById("orange-team").options.length = 0;
 let dropdownBlue = document.getElementById('blue-team');
 let dropdownOrange = document.getElementById('orange-team');

dropdownBlue.length = 0;
dropdownOrange.length = 0;

let defaultOptionBlue = document.createElement('option');
defaultOptionBlue.text = 'Choose Blue Team';

let defaultOptionOrange = document.createElement('option');
defaultOptionOrange.text = 'Choose Orange Team';

dropdownBlue.add(defaultOptionBlue);
dropdownBlue.selectedIndex = 0;

dropdownOrange.add(defaultOptionOrange);
dropdownOrange.selectedIndex = 0;

    for (let i = 0; i < teamArray.length; i++) {
      option = document.createElement('option');
      option.value = teamArray[i].value;
      option.text = teamArray[i].label;
      
      
      dropdownOrange.add(option);
    }
      for (let i = 0; i < teamArray.length; i++) {
      option1 = document.createElement('option');
      option1.text = teamArray[i].label;
      option1.value = teamArray[i].value;
      dropdownBlue.add(option1);
      

      
    }
}

    </script>
    
<script>
    function bluNam() {
    // Check browser support
    if (typeof(Storage) !== "undefined") {
        var sel = document.getElementById("blue-team");
        var bt= sel.options[sel.selectedIndex].label;
        var bf= sel.options[sel.selectedIndex].value;
        localStorage.setItem("BlueTeam", bt);
        localStorage.setItem("BlueFran", bf);
        console.log(bf)
      
    } else {
      document.getElementById("result").innerHTML = "Sorry, your browser does not support Web Storage...";
    }
    blueTeamName();
}
function oranNam() {
    // Check browser support
    if (typeof(Storage) !== "undefined") {
        var sel = document.getElementById("orange-team");
        var ot= sel.options[sel.selectedIndex].label;
        var of= sel.options[sel.selectedIndex].value;
        console.log(of)
        localStorage.setItem("OrangeTeam", ot);
        localStorage.setItem("OrangeFran", of);
      
    } else {
      document.getElementById("result").innerHTML = "Sorry, your browser does not support Web Storage...";
    }
    //blueTeamName();
}
function tier() {
    // Check browser support
    if (typeof(Storage) !== "undefined") {
      // Store
      localStorage.setItem("tier", document.getElementById("tier-dropdown").value);
      // Retrieve
      
    } else {
      document.getElementById("result").innerHTML = "Sorry, your browser does not support Web Storage...";
    }
    //blueTeamName();
}
    </script>
 <script src="logic.js"></script>
 <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>
 <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js'></script>
</body>