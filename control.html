<!DOCTYPE html>
<html lang="en">

<head>

  <title>RSC Stream</title>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lodash@4.17.15/lodash.min.js"></script>
  <script type="text/javascript" src="http://mbostock.github.com/d3/d3.js?2.4.6"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-transform/1.0.4/d3-transform.min.js" integrity="sha512-mxtQ5axoakkabgk9lnYJsaCL+BryRmZ4py80vqOf8UIbZhwc+m1bqmnge6Khd7sOLh2gPFCaKiynJEnqR79CaA==" crossorigin="anonymous"></script>
  

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css'>
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css'>
  <link rel="stylesheet" href="./style.css">
  
</head>

<body>

<select id="tier-dropdown" name="tier" onchange="teams(); tier()"></select>
<select id="blue-team" name="BlueTeam" onchange="bluNam()"></select>
<select id="orange-team" name="OrangeTeam" onchange="oranNam()"></select>

<button  onclick="live()" type="button" style="border-radius: 4px; background-color: #f44336; color: white; border: 2px solid #f44336;">GO LIVE!</button>
<br><br>
<button  onclick="blueWin()" type="button" id="BWButton" style="border-radius: 4px; background-color: #4CAF50; color: white; border: 2px solid #4CAF50;">  +  </button>
<label id="bWins" style="color: white">0</label>
<button  onclick="blueWinRemove()" type="button" id="BRButton" style="border-radius: 4px; background-color: #f44336; color: white; border: 2px solid #f44336;">  -  </button>

<button  onclick="orangeWin()" type="button" id="OWButton" style="border-radius: 4px; background-color: #4CAF50; color: white; border: 2px solid #4CAF50;" class="">  +  </button>
<label id="oWins" style="color: white">0</label>
<button  onclick="orangeWinRemove()" type="button" id="ORButton" style="border-radius: 4px; background-color: #f44336; color: white; border: 2px solid #f44336;">  -  </button>
<br><br>
<div style="display: flex; width: 200px; justify-content: center; align-items: center;">
<h5 style="color: white; text-align: center;">Game Number</h5>
</div>
<div style="display: flex; width: 200px; justify-content: center; align-items: center;">
<button  onclick="gameplus()" type="button" id="GamePlus" style="border-radius: 4px; background-color: #4CAF50; color: white; border: 2px solid #4CAF50;" class="">  +  </button>
<label id="gameNumber" style="color: white; padding-left: 25px; padding-right: 25px; text-align: center;">1</label>
<button  onclick="gameminus()" type="button" id="GameMinus" style="border-radius: 4px; background-color: #f44336; color: white; border: 2px solid #f44336;">  -  </button>

</div>
<script>
  document.getElementById("ORButton").disabled = true
  document.getElementById("BRButton").disabled = true
  document.getElementById("GameMinus").disabled = true
</script>
<script>
    var teamsList = [];
    let dropdownBlue = document.getElementById('blue-team');
    let dropdownOrange = document.getElementById('orange-team');
    let dropdown = document.getElementById('tier-dropdown');
dropdown.length = 0;
dropdownBlue.length = 0;
dropdownOrange.length = 0;

let defaultOption = document.createElement('option');
defaultOption.text = 'Choose Tier';

let defaultOptionBlue = document.createElement('option');
defaultOptionBlue.text = 'Choose Blue Team';

let defaultOptionOrange = document.createElement('option');
defaultOptionOrange.text = 'Choose Orange Team';

dropdown.add(defaultOption);
dropdown.selectedIndex = 0;

dropdownBlue.add(defaultOptionBlue);
dropdownBlue.selectedIndex = 0;

dropdownOrange.add(defaultOptionOrange);
dropdownOrange.selectedIndex = 0;

const url = 'https://cool-grass-d74d.rsc.workers.dev/?https://rsc.webfillet.com/RSCdotNet/api/stats';

const request = new XMLHttpRequest();
request.open('GET', url, true);

request.onload = function() {
  if (request.status === 200) {
    const data = JSON.parse(request.responseText);
    console.log(data)
    teamsList.push(data)
    console.log(teamsList)
    let option;
    for (let i = 0; i < data.length; i++) {
      option = document.createElement('option');
      option.text = data[i].TierName;
      //option.value = data[i].abbreviation;
      dropdown.add(option);
      

      
    }
   } else {
    // Reached the server, but it returned an error
  }   
}

request.onerror = function() {
  console.error('An error occurred fetching the JSON from ' + url);
};

request.send();

function teams() {
    var teams = [];
    var id = [];
    var tier = document.getElementById("tier-dropdown").value;
    console.log(tier)
    id.length = 0;
    if(tier === "Premier"){
        id.push(0)
    }else if(tier === "Master"){
        id.push(1)
    }else if(tier === "Elite"){
        id.push(2)
    }else if(tier === "Major"){
        id.push(3)
    }else if(tier === "Minor"){
        id.push(4)
    }else if(tier === "Challenger"){
        id.push(5)
    }else if(tier === "Prospect"){
        id.push(6)
    }else if(tier === "Contender"){
        id.push(7)
    }else if(tier === "Amateur"){
        id.push(8)
    }

console.log(teamsList[0][0])
    teams.length = 0;
			teamsList[0][id].Teams.forEach(f => {
    teams.push({team: f.TeamName, franchise: f.Franchise});
    })
    console.log(teams)
    let teamArray = [];
    teamArray = []
    console.log(teamArray)
    for (let i = 0; i < teams.length; i++) {
        teamArray.push(
        {"label": teams[i].team, "value": teams[i].franchise}
        );if (i ===teams.length -1)

teamArray.sort(function(a, b){
    if(a.label < b.label) { return -1; }
    if(a.label > b.label) { return 1; }
    return 0;
})


 }
 let option1 = []
 option1 = []
 let option = [];
 option = [];
 
 //document.getElementById("orange-team").options.length = 0;
 let dropdownBlue = document.getElementById('blue-team');
 let dropdownOrange = document.getElementById('orange-team');

dropdownBlue.length = 0;
dropdownOrange.length = 0;

let defaultOptionBlue = document.createElement('option');
defaultOptionBlue.text = 'Choose Blue Team';

let defaultOptionOrange = document.createElement('option');
defaultOptionOrange.text = 'Choose Orange Team';

dropdownBlue.add(defaultOptionBlue);
dropdownBlue.selectedIndex = 0;

dropdownOrange.add(defaultOptionOrange);
dropdownOrange.selectedIndex = 0;

    for (let i = 0; i < teamArray.length; i++) {
      option = document.createElement('option');
      option.value = teamArray[i].value;
      option.text = teamArray[i].label;
      
      
      dropdownOrange.add(option);
    }
      for (let i = 0; i < teamArray.length; i++) {
      option1 = document.createElement('option');
      option1.text = teamArray[i].label;
      option1.value = teamArray[i].value;
      dropdownBlue.add(option1);
      

      
    }
}

    </script>
    
<script>
    function bluNam() {
    // Check browser support
  /*  if (typeof(Storage) !== "undefined") {
        var sel = document.getElementById("blue-team");
        var bt= sel.options[sel.selectedIndex].label;
        var bf= sel.options[sel.selectedIndex].value;
        localStorage.setItem("BlueTeam", bt);
        localStorage.setItem("BlueFran", bf);
        console.log(bf)
      
    } else {
      document.getElementById("result").innerHTML = "Sorry, your browser does not support Web Storage...";
    }
    blueTeamName();  */
}

function oranNam() {
    // Check browser support
 /*   if (typeof(Storage) !== "undefined") {
        var sel = document.getElementById("orange-team");
        var ot= sel.options[sel.selectedIndex].label;
        var of= sel.options[sel.selectedIndex].value;
        console.log(of)
        localStorage.setItem("OrangeTeam", ot);
        localStorage.setItem("OrangeFran", of);
      
    } else {
      document.getElementById("result").innerHTML = "Sorry, your browser does not support Web Storage...";
    }
    //blueTeamName();
    */
}


function tier() {
    // Check browser support
  /*  if (typeof(Storage) !== "undefined") {
      // Store
      localStorage.setItem("tier", document.getElementById("tier-dropdown").value);
      // Retrieve
      
    } else {
      document.getElementById("result").innerHTML = "Sorry, your browser does not support Web Storage...";
    }
    //blueTeamName();
    */
}
var blueW = [0]
console.log(blueW)
function blueWin() {
var getBlueWins = blueW[0] + 1
blueW = []
blueW.push(getBlueWins)
document.getElementById("bWins").innerHTML = blueW[0]
localStorage.setItem("BlueWins", blueW[0]);
if (blueW[0] === 4) {
  document.getElementById("BWButton").disabled = true;
}else{
  document.getElementById("BWButton").disabled = false;
  document.getElementById("BRButton").disabled = false;
}
}

function blueWinRemove() {
var getBlueWins = blueW[0] - 1
blueW = []
blueW.push(getBlueWins)
document.getElementById("bWins").innerHTML = blueW[0]
localStorage.setItem("BlueWins", blueW[0]);
if (blueW[0] === 0) {
  document.getElementById("BRButton").disabled = true;
}else{
  document.getElementById("BRButton").disabled = false;
  document.getElementById("BWButton").disabled = false;
}
}

var orangeW = [0]
function orangeWin() {
var getOrangeWins = orangeW[0] + 1
orangeW = []
orangeW.push(getOrangeWins)
document.getElementById("oWins").innerHTML = orangeW[0]
localStorage.setItem("OrangeWins", orangeW[0]);
if (orangeW[0] === 4) {
  document.getElementById("OWButton").disabled = true;
}else{
  document.getElementById("OWButton").disabled = false;
  document.getElementById("ORButton").disabled = false;
}
}

function orangeWinRemove() {
var getOrangeWins = orangeW[0] - 1
orangeW = []
orangeW.push(getOrangeWins)
document.getElementById("oWins").innerHTML = orangeW[0]
localStorage.setItem("OrangeWins", orangeW[0]);
if (orangeW[0] === 0) {
  document.getElementById("ORButton").disabled = true;
}else{
  document.getElementById("ORButton").disabled = false;
  document.getElementById("OWButton").disabled = false;
}
}

var game = [1]
function gameplus() {
var getGame = game[0] + 1
game = []
game.push(getGame)
document.getElementById("gameNumber").innerHTML = game[0]
localStorage.setItem("GameNumber", game[0]);
if (game[0] === 7) {
  document.getElementById("GamePlus").disabled = true;
}else{
  document.getElementById("GamePlus").disabled = false;
  document.getElementById("GameMinus").disabled = false;
}
}

function gameminus() {
var getGame = game[0] - 1
game = []
game.push(getGame)
document.getElementById("gameNumber").innerHTML = game[0]
localStorage.setItem("GameNumber", game[0]);
if (game[0] === 1) {
  document.getElementById("GameMinus").disabled = true;
}else{
  document.getElementById("GamePlus").disabled = false;
  document.getElementById("GameMinus").disabled = false;
}
}

function live() {
    var sel = document.getElementById("blue-team");
        var bt= sel.options[sel.selectedIndex].label;
        var bf= sel.options[sel.selectedIndex].value;
        console.log(bf)
        localStorage.setItem("BlueTeam", bt);
        localStorage.setItem("BlueFran", bf);
  
      
      var sel1 = document.getElementById("orange-team");
        var ot= sel1.options[sel1.selectedIndex].label;
        var of= sel1.options[sel1.selectedIndex].value;
        console.log(of)
        localStorage.setItem("OrangeTeam", ot);
        localStorage.setItem("OrangeFran", of);

        localStorage.setItem("tier", document.getElementById("tier-dropdown").value);
        
        orangeTeamName();
        blueTeamName();
     
        if (typeof(Storage) !== "undefined") {
    document.getElementById("bWins").innerHTML = localStorage.getItem("BlueWins");
        }
}
    </script>
 <script src="logic.js"></script>
 <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>
 <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js'></script>
</body>